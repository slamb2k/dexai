# Multi-Modal Messaging Configuration
# Phase 15a: Images, Documents, Code Blocks
# Phase 15b: Audio/Voice Transcription, Video Processing, TTS

# =============================================================================
# Media Processing Settings
# =============================================================================
processing:
  enabled: true
  max_file_size_mb: 50
  max_processing_cost_usd: 0.20  # Per message limit

  # Vision API for images
  vision:
    enabled: true
    provider: "anthropic"  # Direct Claude Vision
    max_images_per_message: 3  # ADHD: don't overwhelm
    max_cost_per_image: 0.05
    # Pricing per million tokens (for cost tracking)
    pricing:
      input_per_mtok: 3.0    # Sonnet input
      output_per_mtok: 15.0  # Sonnet output
    auto_analyze_triggers:
      - "what is"
      - "can you see"
      - "look at"
      - "screenshot"
      - "in the image"
      - "in the picture"

  # Document text extraction
  documents:
    enabled: true
    extract_text: true
    max_pages: 20
    max_chars_per_doc: 10000
    supported_formats:
      - "pdf"
      - "docx"
      - "txt"
      - "md"

  # Audio/Voice transcription (Phase 15b)
  transcription:
    enabled: true
    provider: "openai"        # Whisper API
    model: "whisper-1"
    max_duration_seconds: 300  # 5 minutes max
    language_hint: null        # Auto-detect (or set to "en", "es", etc.)
    # Pricing (for cost tracking)
    pricing:
      per_minute_usd: 0.006   # Whisper pricing
    # Supported audio formats
    supported_formats:
      - "mp3"
      - "mp4"
      - "mpeg"
      - "mpga"
      - "m4a"
      - "wav"
      - "webm"
      - "ogg"
      - "flac"

  # Video processing (Phase 15b)
  video:
    enabled: true
    max_file_size_mb: 100     # Larger limit for video
    max_duration_seconds: 300  # 5 minutes max
    transcribe_audio: true     # Extract and transcribe audio track
    extract_frames: true       # Extract key frames for analysis
    analyze_frames: true       # Use Vision API on frames
    max_frames: 3              # Max frames to extract (ADHD-friendly)
    # Supported video formats
    supported_formats:
      - "mp4"
      - "webm"
      - "avi"
      - "mov"
      - "mkv"
      - "m4v"
      - "3gp"

# =============================================================================
# Content Formatting Settings
# =============================================================================
formatting:
  # Code block handling
  code:
    detect_language: true
    max_inline_lines: 20  # ADHD: collapse longer blocks

  # Message splitting
  channel_limits:
    telegram: 4096
    discord: 2000
    slack: 40000

# =============================================================================
# Storage Settings (Phase 15d full implementation)
# =============================================================================
storage:
  temp_retention_hours: 1
  cleanup_enabled: true

# =============================================================================
# Generation Settings
# =============================================================================
generation:
  # Image generation (DALL-E)
  enabled: true
  model: "dall-e-3"
  max_cost_per_image: 0.10
  default_size: "1024x1024"
  default_quality: "standard"
  # Pricing per image (for cost tracking)
  pricing:
    standard_square: 0.040   # 1024x1024
    standard_wide: 0.080     # 1792x1024 or 1024x1792
    hd_square: 0.080         # HD 1024x1024
    hd_wide: 0.120           # HD 1792x1024 or 1024x1792

  # Text-to-Speech generation (Phase 15b)
  tts:
    enabled: false            # Opt-in (uses API credits)
    provider: "openai"
    model: "tts-1"            # or "tts-1-hd" for higher quality
    voice: "alloy"            # alloy, echo, fable, onyx, nova, shimmer
    speed: 1.0                # 0.25 to 4.0
    output_format: "opus"     # opus (best for voice notes), mp3, aac, flac
    max_chars: 4096           # OpenAI limit
    # Pricing (for cost tracking)
    pricing:
      per_1k_chars_usd: 0.015     # tts-1
      hd_per_1k_chars_usd: 0.030  # tts-1-hd

# =============================================================================
# Platform Rendering Settings (Phase 15c)
# =============================================================================
rendering:
  enabled: true

  # Per-platform rendering configuration
  telegram:
    parse_mode: "HTML"          # HTML or MarkdownV2
    max_media_group: 10         # Max images per media group
    disable_web_preview: false  # Disable link previews

  discord:
    embed_color: 0x5865F2       # Default embed color (blurple)
    max_embeds: 10              # Max embeds per message
    use_embeds_for_images: true # Wrap images in embeds

  slack:
    max_blocks: 50              # Slack block limit per message
    mrkdwn_limit: 3000          # Max chars per mrkdwn section
    unfurl_links: false         # Disable automatic URL previews

# =============================================================================
# Interactive Elements Settings (Phase 15d)
# =============================================================================
interactive:
  enabled: true
  db_path: null  # Defaults to data/media.db

  buttons:
    max_per_message: 5          # Max buttons per group
    default_expiry_hours: 24    # Button callback expiration

  polls:
    max_options: 10             # Max poll options
    default_expiry_hours: 48    # Poll auto-close time
    allow_multiple_choice: true

  # Location processing
  location:
    geocoding_enabled: true
    provider: "nominatim"       # Free, no API key needed
    rate_limit_seconds: 1.0     # Nominatim requires 1 req/sec

  # Contact processing
  contacts:
    vcard_parsing: true
    store_contacts: false       # Don't persist by default (privacy)

# =============================================================================
# ADHD-Friendly Settings
# =============================================================================
adhd:
  acknowledge_processing: true  # "Analyzing your image..."
  summarize_multiple: true      # "I see 3 images: ..."
  max_attachments: 3            # Process max 3 per message
  # Voice-specific ADHD considerations
  voice:
    summarize_long_transcripts: true  # Summarize transcripts > 500 words
    max_transcript_display: 500        # Chars to show inline (rest collapsed)
